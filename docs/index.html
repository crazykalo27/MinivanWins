<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Turn Simulation - Celica vs Caravan</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöó Vehicle Turn Simulation üöê</h1>
            <p class="subtitle">Toyota Celica (2004) vs Dodge Caravan (2016)</p>
            <div class="current-speed" id="currentSpeedDisplay">Current test speed: 0 mph</div>
        </header>

        <div class="controls-panel">
            <div class="control-group">
                <label for="turnAngle">Turn Angle</label>
                <div class="control-row">
                    <input type="range" id="turnAngle" min="15" max="90" value="45" step="5">
                    <span class="value-display" id="turnAngleValue">45¬∞</span>
                </div>
            </div>
            <div class="control-group">
                <label for="trackRadius">Track Radius (ft)</label>
                <div class="control-row">
                    <input type="range" id="trackRadius" min="25" max="200" value="75" step="5">
                    <span class="value-display" id="trackRadiusValue">75 ft</span>
                </div>
            </div>
            <div class="control-group">
                <label for="frictionCoeff">Friction (Œº)</label>
                <div class="control-row">
                    <input type="range" id="frictionCoeff" min="0.3" max="1.2" value="0.3" step="0.1">
                    <span class="value-display" id="frictionCoeffValue">0.3</span>
                </div>
            </div>
            <div class="control-group">
                <label for="speedStep">Speed Step (mph)</label>
                <input type="number" id="speedStep" min="0.001" value="1" step="any" class="speed-step-input">
            </div>
            <div class="control-group speed-control-group">
                <label>Simulation Speed</label>
                <div class="speed-slider-container">
                    <span class="speed-label speed-label-slow">Slow</span>
                    <input type="range" id="simSpeedSlider" min="0" max="100" value="100" step="1" class="speed-slider">
                    <span class="speed-label speed-label-fast">Fast</span>
                </div>
                <div class="speed-value-display">
                    <span id="simSpeedValue">50x</span>
                </div>
            </div>
            <div class="control-group failure-modes-group">
                <label>Failure Modes</label>
                <div class="checkbox-row">
                    <label class="checkbox-label">
                        <input type="checkbox" id="ignoreSlipping" class="failure-checkbox">
                        <span>Ignore Slipping (Spin-out)</span>
                    </label>
                </div>
                <div class="checkbox-row">
                    <label class="checkbox-label">
                        <input type="checkbox" id="ignoreTipping" class="failure-checkbox">
                        <span>Ignore Tipping (Rollover)</span>
                    </label>
                </div>
            </div>
            <div class="control-group buttons-group">
                <label>Actions</label>
                <div class="control-row buttons-row">
                    <button id="startBtn" class="btn btn-primary">Start</button>
                    <button id="resetBtn" class="btn btn-secondary">Reset</button>
                </div>
            </div>
        </div>

        <div class="simulation-container">
            <div class="vehicle-panel">
                <div class="vehicle-header">
                    <h2>üöó Toyota Celica</h2>
                    <div class="stats">
                        <div class="stat">Speed: <span id="corollaSpeed">0</span> mph</div>
                        <div class="stat">Status: <span id="corollaStatus">Ready</span></div>
                    </div>
                </div>
                <div class="track-container" id="corollaTrack">
                    <canvas id="corollaCanvas"></canvas>
                    <img src="assets/celica.png" alt="Celica" class="vehicle-image" id="corollaImage">
                </div>
                <div class="analysis" id="corollaAnalysis">Adjust angle and friction, then start to see how the Celica handles the turn.</div>
            </div>

            <div class="vehicle-panel">
                <div class="vehicle-header">
                    <h2>üöê Dodge Caravan</h2>
                    <div class="stats">
                        <div class="stat">Speed: <span id="caravanSpeed">0</span> mph</div>
                        <div class="stat">Status: <span id="caravanStatus">Ready</span></div>
                    </div>
                </div>
                <div class="track-container" id="caravanTrack">
                    <canvas id="caravanCanvas"></canvas>
                    <img src="assets/minivan.png" alt="Caravan" class="vehicle-image" id="caravanImage">
                </div>
                <div class="analysis" id="caravanAnalysis">Adjust angle and friction, then start to see how the Caravan handles the turn.</div>
            </div>
        </div>

        <div class="vehicle-specs-section">
            <h3>Vehicle Specifications</h3>
            <div class="specs-container">
                <div class="vehicle-spec-card">
                    <h4>üöó Toyota Celica (2004)</h4>
                    <div class="vehicle-description">
                        <div class="spec-row"><strong>Year:</strong> 2004</div>
                        <div class="spec-row"><strong>Weight:</strong> 2,650 lbs</div>
                        <div class="spec-row"><strong>Center of Mass:</strong> 21"</div>
                        <div class="spec-row"><strong>Wheelbase:</strong> 102.4"</div>
                        <div class="spec-row"><strong>Track Width:</strong> 59.9" / 59.4"</div>
                        <div class="spec-row"><strong>Drive:</strong> Front-Wheel Drive</div>
                    </div>
                </div>
                <div class="vehicle-spec-card">
                    <h4>üöê Dodge Caravan (2016)</h4>
                    <div class="vehicle-description">
                        <div class="spec-row"><strong>Year:</strong> 2016</div>
                        <div class="spec-row"><strong>Weight:</strong> 4,560 lbs</div>
                        <div class="spec-row"><strong>Center of Mass:</strong> 27"</div>
                        <div class="spec-row"><strong>Wheelbase:</strong> 121.2"</div>
                        <div class="spec-row"><strong>Track Width:</strong> 64.8" / 64.8"</div>
                        <div class="spec-row"><strong>Drive:</strong> Front-Wheel Drive</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="math-section">
            <h3>üìê Physics Equations Used in Simulation</h3>
            <div class="math-content">
                <div class="math-formula">
                    <h4>1. Turn Radius (R)</h4>
                    <div class="formula-large">R = Track Radius</div>
                    <div class="formula-units">Units: feet (ft)</div>
                    <div class="formula-desc">
                        <strong>Definition:</strong> The curve radius is a fixed property of the road geometry. Both vehicles must navigate the same curve.<br><br>
                        <strong>Typical Values:</strong><br>
                        ‚Ä¢ City street: 25-50 ft<br>
                        ‚Ä¢ Highway ramp: 100-500 ft<br>
                        ‚Ä¢ Default in simulation: 75 ft
                    </div>
                </div>
                <div class="math-formula">
                    <h4>2. Lateral Acceleration (a<sub>lat</sub>)</h4>
                    <div class="formula-large">a<sub>lat</sub> = v¬≤ / R</div>
                    <div class="formula-units">Units: ft/s¬≤ (where v is in ft/s, R is in ft)</div>
                    <div class="formula-desc">
                        <strong>Definition:</strong> Centripetal acceleration required to maintain the turn at speed v.<br><br>
                        <strong>Example Calculation:</strong><br>
                        At 30 mph (44 ft/s) with R = 75 ft:<br>
                        a<sub>lat</sub> = 44¬≤ / 75 = 1,936 / 75 = <strong>25.8 ft/s¬≤</strong> ‚âà 0.8g<br><br>
                        <strong>Conversion:</strong> 1 mph = 1.467 ft/s
                    </div>
                </div>
                <div class="math-formula">
                    <h4>3. Spin-Out Limit (a<sub>max</sub>)</h4>
                    <div class="formula-large">a<sub>max</sub> = Œº √ó g √ó ‚àö(weight/3000) √ó drive_factor</div>
                    <div class="formula-units">Units: ft/s¬≤</div>
                    <div class="formula-desc">
                        <strong>Variables:</strong><br>
                        ‚Ä¢ Œº (mu) = friction coefficient (0.3-1.2)<br>
                        ‚Ä¢ g = gravitational acceleration = 32.174 ft/s¬≤<br>
                        ‚Ä¢ weight = vehicle weight in lbs<br>
                        ‚Ä¢ drive_factor = 1.05 (FWD) or 0.98 (RWD)<br><br>
                        <strong>Definition:</strong> Maximum lateral acceleration before tire grip is lost. Heavier vehicles have better grip due to larger tire contact patches. FWD vehicles are slightly more stable.
                    </div>
                </div>
                <div class="math-formula">
                    <h4>4. Rollover Limit (a<sub>rollover</sub>)</h4>
                    <div class="formula-large">a<sub>rollover</sub> = (track_width / (2 √ó CoM_height)) √ó g</div>
                    <div class="formula-units">Units: ft/s¬≤</div>
                    <div class="formula-desc">
                        <strong>Static Stability Factor (SSF):</strong><br>
                        SSF = track_width / (2 √ó CoM_height)<br><br>
                        <strong>Variables:</strong><br>
                        ‚Ä¢ track_width = average of front and rear track (inches)<br>
                        ‚Ä¢ CoM_height = center of mass height (inches)<br>
                        ‚Ä¢ g = 32.174 ft/s¬≤<br><br>
                        <strong>Definition:</strong> Maximum lateral acceleration before rollover. Wider track and lower center of mass increase stability. Typical SSF: Minivans ~1.1, Sedans ~1.4.
                    </div>
                </div>
                <div class="math-formula">
                    <h4>5. Failure Condition</h4>
                    <div class="formula-large">Failure when: a<sub>lat</sub> > min(a<sub>max</sub>, a<sub>rollover</sub>)</div>
                    <div class="formula-units">Failure occurs when margin < 0</div>
                    <div class="formula-desc">
                        <strong>Failure Detection:</strong><br>
                        ‚Ä¢ Spin-out margin = a<sub>max</sub> - a<sub>lat</sub><br>
                        ‚Ä¢ Rollover margin = a<sub>rollover</sub> - a<sub>lat</sub><br><br>
                        <strong>Failure occurs when:</strong><br>
                        ‚Ä¢ Spin-out margin < 0 ‚Üí Vehicle loses grip (spin-out)<br>
                        ‚Ä¢ Rollover margin < 0 ‚Üí Vehicle tips over (rollover)<br><br>
                        <strong>Failure Type:</strong> Whichever limit is lower determines the failure mode. If both margins are negative, the more negative one fails first.
                    </div>
                </div>
            </div>
        </div>

        <div id="fireworks-container"></div>
        <div class="winner-summary" id="winnerSummary">Run the simulation to see which vehicle wins and why.</div>
    </div>

    <script src="physics.js"></script>
    <script src="simulation.js"></script>
    <script src="fireworks.js"></script>
    <script src="app.js"></script>
</body>
</html>

