<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Turn Simulation - Celica vs Caravan</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöó Vehicle Turn Simulation üöê</h1>
            <p class="subtitle">Toyota Celica (2004) vs Dodge Caravan (2016)</p>
            <div class="current-speed" id="currentSpeedDisplay">Current test speed: 0 mph</div>
        </header>

        <div class="controls-panel">
            <div class="control-group">
                <label for="turnAngle">Turn Angle</label>
                <div class="control-row">
                    <input type="range" id="turnAngle" min="15" max="90" value="45" step="5">
                    <span class="value-display" id="turnAngleValue">45¬∞</span>
                </div>
            </div>
            <div class="control-group">
                <label for="trackRadius">Track Radius (ft)</label>
                <div class="control-row">
                    <input type="range" id="trackRadius" min="25" max="200" value="75" step="5">
                    <span class="value-display" id="trackRadiusValue">75 ft</span>
                </div>
            </div>
            <div class="control-group">
                <label for="frictionCoeff">Friction (Œº)</label>
                <div class="control-row">
                    <input type="range" id="frictionCoeff" min="0.3" max="1.2" value="0.7" step="0.1">
                    <span class="value-display" id="frictionCoeffValue">0.7</span>
                </div>
            </div>
            <div class="control-group">
                <label for="speedStep">Speed Step (mph)</label>
                <input type="number" id="speedStep" min="0.001" value="1" step="any" class="speed-step-input">
            </div>
            <div class="control-group speed-control-group">
                <label>Simulation Speed</label>
                <div class="speed-slider-container">
                    <span class="speed-label speed-label-slow">Slow</span>
                    <input type="range" id="simSpeedSlider" min="0" max="100" value="50" step="1" class="speed-slider">
                    <span class="speed-label speed-label-fast">Fast</span>
                </div>
                <div class="speed-value-display">
                    <span id="simSpeedValue">1.0x</span>
                </div>
            </div>
            <div class="control-group failure-modes-group">
                <label>Failure Modes</label>
                <div class="checkbox-row">
                    <label class="checkbox-label">
                        <input type="checkbox" id="ignoreSlipping" class="failure-checkbox">
                        <span>Ignore Slipping (Spin-out)</span>
                    </label>
                </div>
                <div class="checkbox-row">
                    <label class="checkbox-label">
                        <input type="checkbox" id="ignoreTipping" class="failure-checkbox">
                        <span>Ignore Tipping (Rollover)</span>
                    </label>
                </div>
            </div>
            <div class="control-group buttons-group">
                <label>Actions</label>
                <div class="control-row buttons-row">
                    <button id="startBtn" class="btn btn-primary">Start</button>
                    <button id="resetBtn" class="btn btn-secondary">Reset</button>
                </div>
            </div>
        </div>

        <div class="simulation-container">
            <div class="vehicle-panel">
                <div class="vehicle-header">
                    <h2>üöó Toyota Celica</h2>
                    <div class="stats">
                        <div class="stat">Speed: <span id="corollaSpeed">0</span> mph</div>
                        <div class="stat">Status: <span id="corollaStatus">Ready</span></div>
                    </div>
                </div>
                <div class="vehicle-description">
                    <div class="spec-row"><strong>Year:</strong> 2004</div>
                    <div class="spec-row"><strong>Weight:</strong> 2,650 lbs</div>
                    <div class="spec-row"><strong>Center of Mass:</strong> 21"</div>
                    <div class="spec-row"><strong>Wheelbase:</strong> 102.4"</div>
                    <div class="spec-row"><strong>Track Width:</strong> 59.9" / 59.4"</div>
                    <div class="spec-row"><strong>Drive:</strong> Front-Wheel Drive</div>
                </div>
                <div class="track-container" id="corollaTrack">
                    <canvas id="corollaCanvas"></canvas>
                    <img src="assets/celica.png" alt="Celica" class="vehicle-image" id="corollaImage">
                </div>
                <div class="analysis" id="corollaAnalysis">Adjust angle and friction, then start to see how the Celica handles the turn.</div>
            </div>

            <div class="vehicle-panel">
                <div class="vehicle-header">
                    <h2>üöê Dodge Caravan</h2>
                    <div class="stats">
                        <div class="stat">Speed: <span id="caravanSpeed">0</span> mph</div>
                        <div class="stat">Status: <span id="caravanStatus">Ready</span></div>
                    </div>
                </div>
                <div class="vehicle-description">
                    <div class="spec-row"><strong>Year:</strong> 2016</div>
                    <div class="spec-row"><strong>Weight:</strong> 4,560 lbs</div>
                    <div class="spec-row"><strong>Center of Mass:</strong> 27"</div>
                    <div class="spec-row"><strong>Wheelbase:</strong> 121.2"</div>
                    <div class="spec-row"><strong>Track Width:</strong> 64.8" / 64.8"</div>
                    <div class="spec-row"><strong>Drive:</strong> Front-Wheel Drive</div>
                </div>
                <div class="track-container" id="caravanTrack">
                    <canvas id="caravanCanvas"></canvas>
                    <img src="assets/minivan.png" alt="Caravan" class="vehicle-image" id="caravanImage">
                </div>
                <div class="analysis" id="caravanAnalysis">Adjust angle and friction, then start to see how the Caravan handles the turn.</div>
            </div>
        </div>

        <div class="math-section">
            <h3>Physics Equations</h3>
            <div class="math-content">
                <div class="math-formula">
                    <h4>Turn Radius</h4>
                    <div class="formula">R = Track Radius (fixed property of the road)</div>
                    <div class="formula-desc">The curve radius is determined by the road geometry. Both vehicles must navigate the same curve. Typical values: City street 25-50 ft, Highway ramp 100-500 ft.</div>
                </div>
                <div class="math-formula">
                    <h4>Lateral Acceleration</h4>
                    <div class="formula">a<sub>lat</sub> = v¬≤ / R</div>
                    <div class="formula-desc">Centripetal acceleration required for the turn. At 30 mph (44 fps) with R=75 ft: a = 44¬≤ / 75 = 25.8 ft/s¬≤ ‚âà 0.8g</div>
                </div>
                <div class="math-formula">
                    <h4>Spin-Out Limit</h4>
                    <div class="formula">a<sub>max</sub> = Œº √ó g √ó ‚àö(weight/3000) √ó drive_factor</div>
                    <div class="formula-desc">Maximum lateral acceleration before tire grip is lost. Œº = friction coefficient (0.7 dry road), g = 32.174 ft/s¬≤. FWD: √ó1.05, RWD: √ó0.98.</div>
                </div>
                <div class="math-formula">
                    <h4>Rollover Limit (SSF)</h4>
                    <div class="formula">a<sub>rollover</sub> = (track_width / (2 √ó CoM_height)) √ó g</div>
                    <div class="formula-desc">Static Stability Factor determines rollover threshold. Wider track and lower center of mass increase stability. Minivans typically have lower SSF (~1.1) vs sedans (~1.4).</div>
                </div>
                <div class="math-formula">
                    <h4>Failure Condition</h4>
                    <div class="formula">Failure when: a<sub>lat</sub> > min(a<sub>spinout</sub>, a<sub>rollover</sub>)</div>
                    <div class="formula-desc">The vehicle fails when lateral acceleration exceeds either the spin-out or rollover limit. Whichever limit is lower determines the failure mode.</div>
                </div>
            </div>
        </div>

        <div id="fireworks-container"></div>
        <div class="winner-summary" id="winnerSummary">Run the simulation to see which vehicle wins and why.</div>
    </div>

    <script src="physics.js"></script>
    <script src="simulation.js"></script>
    <script src="fireworks.js"></script>
    <script src="app.js"></script>
</body>
</html>

